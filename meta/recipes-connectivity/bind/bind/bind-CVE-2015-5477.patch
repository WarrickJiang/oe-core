From a7fef8b70d949c2a5b30b68131d7bed159d6e3fe Mon Sep 17 00:00:00 2001
From: Mark Andrews <marka@isc.org>
Date: Tue, 14 Jul 2015 14:48:42 +1000
Subject: [PATCH 1/1] 4165. [bug] An failure to reset a value to NULL in tkey.c
 could result in an assertion failure. (CVE-2015-5477) [RT #40046]

Signed-off-by: Shan Hai <shan.hai@windriver.com>
---
 CHANGES        | 4 ++++
 lib/dns/tkey.c | 1 +
 2 files changed, 5 insertions(+)

diff --git a/CHANGES b/CHANGES
index 66f3f25..1d03dc1 100644
--- a/CHANGES
+++ b/CHANGES
@@ -1,3 +1,7 @@
+4165.	[bug]		An failure to reset a value to NULL in tkey.c could
+			result in an assertion failure. (CVE-2015-5477)
+			[RT #40046]
+
 4138.	[bug]		A uninitialized value in validator.c could result
 			in a assertion failure. (CVE-2015-4620) [RT #39795]
 
diff --git a/lib/dns/tkey.c b/lib/dns/tkey.c
index 11b4f49..ada26bc 100644
--- a/lib/dns/tkey.c
+++ b/lib/dns/tkey.c
@@ -650,6 +650,7 @@ dns_tkey_processquery(dns_message_t *msg, dns_tkeyctx_t *tctx,
 		 * Try the answer section, since that's where Win2000
 		 * puts it.
 		 */
+		name = NULL;
 		if (dns_message_findname(msg, DNS_SECTION_ANSWER, qname,
 					 dns_rdatatype_tkey, 0, &name,
 					 &tkeyset) != ISC_R_SUCCESS) {
-- 
1.8.5.2.233.g932f7e4

