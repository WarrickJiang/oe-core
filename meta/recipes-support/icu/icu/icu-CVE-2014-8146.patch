
Upstream-Status: Backport

Signed-off-by: Yue Tao <yue.tao@windriver.com>

Index: source/common/ubidi.c
===================================================================
--- source/common/ubidi.c	(revision 37161)
+++ source/common/ubidi.c	(revision 37162)
@@ -2138,7 +2138,7 @@
     /* The isolates[] entries contain enough information to
        resume the bidi algorithm in the same state as it was
        when it was interrupted by an isolate sequence. */
-    if(dirProps[start]==PDI) {
+    if(dirProps[start]==PDI  && pBiDi->isolateCount >= 0) {
         levState.startON=pBiDi->isolates[pBiDi->isolateCount].startON;
         start1=pBiDi->isolates[pBiDi->isolateCount].start1;
         stateImp=pBiDi->isolates[pBiDi->isolateCount].stateImp;
