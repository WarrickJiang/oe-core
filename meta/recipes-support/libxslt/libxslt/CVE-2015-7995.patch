Fix for type confusion in preprocessing attributes

CVE-2015-7995 http://www.openwall.com/lists/oss-security/2015/10/27/10
We need to check that the parent node is an element before dereferencing
its namespace

Upstream-Status: Backport

https://git.gnome.org/browse/libxslt/commit/?id=7ca19df892ca22d9314e95d59ce2abdeff46b617

Signed-off-by: Armin Kuster <akuster@mvista.com>

diff -Nur libxslt-1.1.28.orig/libxslt/preproc.c libxslt-1.1.28/libxslt/preproc.c
--- libxslt-1.1.28.orig/libxslt/preproc.c	2015-12-03 10:48:16.967422102 +0800
+++ libxslt-1.1.28/libxslt/preproc.c	2015-12-03 10:52:17.583423779 +0800
@@ -2245,7 +2245,8 @@
 	} else if (IS_XSLT_NAME(inst, "attribute")) {
 	    xmlNodePtr parent = inst->parent;
 
-	    if ((parent == NULL) || (parent->ns == NULL) ||
+	    if ((parent == NULL) ||
+	        (parent->type != XML_ELEMENT_NODE) || (parent->ns == NULL) ||
 		((parent->ns != inst->ns) &&
 		 (!xmlStrEqual(parent->ns->href, inst->ns->href))) ||
 		(!xmlStrEqual(parent->name, BAD_CAST "attribute-set"))) {
