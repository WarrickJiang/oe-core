From ddff5b8e5a0f66cf91916184a1e890002f9ef0b5 Mon Sep 17 00:00:00 2001
From: Liu Haitao <haitao.liu@windriver.com>
Date: Wed, 9 May 2018 00:22:59 -0700
Subject: [PATCH] sqlite3:fix CVE-2017-15286

Make sure the tableColumnList() routine of the command-line shell does not
cause a null-pointer dereference in an error condition.

Upstream-status: Backport [http://www.sqlite.org/src/info/5d0ceb8dcdef92cd]

Signed-off-by: Liu Haitao <haitao.liu@windriver.com>
---
 shell.c | 1 +
 1 file changed, 1 insertion(+)

diff --git a/shell.c b/shell.c
index 6673536..77377bd 100644
--- a/shell.c
+++ b/shell.c
@@ -3809,6 +3809,7 @@ static char **tableColumnList(ShellState *p, const char *zTab){
     }
   }
   sqlite3_finalize(pStmt);
+  if(azCol == 0) return 0;
   azCol[0] = 0;
   azCol[nCol+1] = 0;
 
-- 
2.11.0

