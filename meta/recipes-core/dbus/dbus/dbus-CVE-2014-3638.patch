From 560df5df8321625da5c8d1f9f4fd66600906a636 Mon Sep 17 00:00:00 2001
From: Alban Crequy <alban.crequy@collabora.co.uk>
Date: Thu, 10 Jul 2014 15:08:06 +0100
Subject: [PATCH 1/1] system bus limit: use max_replies_per_connection=128 by
 default

This addresses CVE-2014-3638.

Bug: https://bugs.freedesktop.org/show_bug.cgi?id=81053
Reviewed-by: Simon McVittie <simon.mcvittie@collabora.co.uk>
Signed-off-by: Shan Hai <shan.hai@windriver.com>
---
 bus/config-parser.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/bus/config-parser.c b/bus/config-parser.c
index c07018e..461fa2e 100644
--- a/bus/config-parser.c
+++ b/bus/config-parser.c
@@ -472,7 +472,7 @@ bus_config_parser_new (const DBusString      *basedir,
       /* this is effectively a limit on message queue size for messages
        * that require a reply
        */
-      parser->limits.max_replies_per_connection = 1024*8;
+      parser->limits.max_replies_per_connection = 128;
     }
       
   parser->refcount = 1;
-- 
1.9.1

