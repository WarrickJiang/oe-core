systemd: CVE-2015-8842 befor v229

the patch comes from:
https://bugzilla.suse.com/show_bug.cgi?id=972612
https://github.com/systemd/systemd/commit/afae249efa4774c6676738ac5de6aeb4daf4889f

tmpfiles: set acls on system.journal explicitly

Signed-off-by: Li Wang <li.wang@windriver.com>
---
 tmpfiles.d/systemd.conf.m4 |    2 ++
 1 file changed, 2 insertions(+)

diff --git a/tmpfiles.d/systemd.conf.m4 b/tmpfiles.d/systemd.conf.m4
index d9d51af..66fc6c2 100644
--- a/tmpfiles.d/systemd.conf.m4
+++ b/tmpfiles.d/systemd.conf.m4
@@ -33,9 +33,11 @@ A+ /run/log/journal/%m - - - - group:adm:r-x,group:wheel:r-x
 
 z /var/log/journal 2755 root systemd-journal - -
 z /var/log/journal/%m 2755 root systemd-journal - -
+z /var/log/journal/%m/system.journal 0640 root systemd-journal - -
 m4_ifdef(`HAVE_ACL',``
 a+ /var/log/journal/%m - - - - d:group:adm:r-x,d:group:wheel:r-x
 a+ /var/log/journal/%m - - - - group:adm:r-x,group:wheel:r-x
+a+ /var/log/journal/%m/system.journal - - - - group:adm:r--,group:wheel:r--
 '')m4_dnl
 
 d /var/lib/systemd 0755 root root -
-- 
1.7.9.5

