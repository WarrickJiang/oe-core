
util-linux:CVE-2015-5218

A flaw was reported in colcrt:
When running colcrt with a big input it crashes because 
of a global-buffer-overflow caused by a global variable 
'page' defined in 'text-utils/colcrt.c:73:9

It is unclear whether this can be used to execute code 
on the system.

Upstream patches:
https://github.com/kerolasa/lelux-utiliteetit/commit/
70e3fcf293c1827a2655a86584ab13075124a8a8
https://github.com/kerolasa/lelux-utiliteetit/commit/
d883d64d96ab9bef510745d064a351145b9babec

diff --git util-linux-2.24.2-ori/text-utils/colcrt.c util-linux-2.24.2/text-utils/colcrt.c
index 6c7f636..8014ec4 100644
--- util-linux-2.24.2-ori/text-utils/colcrt.c
+++ util-linux-2.24.2/text-utils/colcrt.c
@@ -68,7 +68,7 @@ static void __attribute__ ((__noreturn__)) usage(FILE * out);
  * Option -2 forces printing of all half lines.
  */
 
-wchar_t	page[267][132];
+wchar_t	page[268][133];
 
 int	outline = 1;
 int	outcol;
@@ -200,6 +200,8 @@ void colcrt(FILE *f) {
 			/* fallthrough */
 		default:
 			w = wcwidth(c);
+			if (w < 0)
+				continue;
 			if (outcol + w > 132) {
 				outcol++;
 				continue;
